<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <meta charset="utf-8">

    <title>尼泊尔地震（无云产品比较）</title>

    <script src="js/jquery.min.js"></script>
    <link rel="stylesheet" href="css/bootstrap.min.css">
    <script src="js/bootstrap.min.js"></script>

    <link rel="stylesheet" href="css/ol.css" type="text/css">
    <script src="js/ol.js"></script>

    <link href="css/offcanvas.css" rel="stylesheet">

    <style>

        .map {
            height: 100%;
            width: 100%;
        }

        .ah {
            height: 100%;
        }

        .hh {
            height: 50%;
        }
		
		.nopadding {
			padding: 0;
		}

	</style>
</head>
<body>

<div class="row ah">

    <div class="col-md-2 ah">
	<h1>尼泊尔地震变化检测</h1>
	<p>
地震等灾害发生后短时间内地物发生重大的变化，需要一张全面更新的影像地图作为救灾工作的指导依据。而光学卫星常常受到云雾干扰，通过多时相融合生成一幅无云的影像地图非常有必要。<br/><br/>

这个示例左边是地震前4月11日和地震后4月27日的影像的直接对比，在雨雾下面还有不少重大的损毁没有看到。右边是地震前4月11日和地震后多日融合影像的对比，可以在一个简单的交互界面上看到整个区域全面的损毁情况。<br/><br/>
		
	</p>
	</div>
	
    <div id="map1" class="col-md-5 ah nopadding">
	</div>
    <div id="map2" class="col-md-5 ah nopadding">
	</div>
	
</div>

<script>
    var extent = [0, 0, 1960, 1960];
    var projection = new ol.proj.Projection({
        code: 'xkcd-image',
        units: 'pixels',
        extent: extent
    });

    source1 = new ol.source.ImageStatic({
        attributions: [
            new ol.Attribution({
                html: '【4月11日 地震前】'
            })
        ],
        url: 'http://novachen.github.io/images/e0411.jpg',
        projection: projection,
        imageExtent: extent
    });

    source2 = new ol.source.ImageStatic({
        attributions: [
            new ol.Attribution({
                html: '【4月27日 地震后】'
            })
        ],
        url: 'http://novachen.github.io/images/e0427.jpg',
        projection: projection,
        imageExtent: extent
    });


	source3 = new ol.source.ImageStatic({
        attributions: [
            new ol.Attribution({
                html: '无云融合'
            })
        ],
        url: 'http://novachen.github.io/images/MERGE2.jpg',
        projection: projection,
        imageExtent: extent
    });
	
	
    layer1 = new ol.layer.Image({
        source: source1
    });

    layer2 = new ol.layer.Image({
        source: source2
    });

    layer3 = new ol.layer.Image({
        source: source3
    });

	view = new ol.View({
        projection: projection,
        center: [500,1150],
        zoom: 4
    });

    var map1 = new ol.Map({
        layers: [
            new ol.layer.Group({
                layers: [
                    layer2,
                    layer1
                ]

            })
        ],
        renderer: 'canvas',
        target: 'map1',
        view: view
    });

    var map2 = new ol.Map({
        layers: [
            new ol.layer.Group({
                layers: [
                    layer3,
                    layer1
                ]

            })
        ],
        renderer: 'canvas',
        target: 'map2',
        view: view
    });


	layer1.setVisible(true);
	layer2.setVisible(false);
	layer3.setVisible(false);
	
    setInterval('flickImage()', 1000);

    function flickImage() {
        layer1.setVisible(!layer1.getVisible());
        layer2.setVisible(!layer2.getVisible());
        layer3.setVisible(!layer3.getVisible());
    }

</script>
</body>
</html>