<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <meta charset="utf-8">
	
<title>Overlay example</title>
<script src="https://code.jquery.com/jquery-1.11.2.min.js"></script>
<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.4/css/bootstrap.min.css">
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.4/js/bootstrap.min.js"></script>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/ol3/3.5.0/ol.css" type="text/css">
<script src="https://cdnjs.cloudflare.com/ajax/libs/ol3/3.5.0/ol.js"></script>
    <link href="css/offcanvas.css" rel="stylesheet">
	

<style>
.marker {
  width: 20px;
  height: 20px;
  border: 1px solid #088;
  border-radius: 10px;
  background-color: #0FF;
  opacity: 0.5;
}
.city {
  text-decoration: none;
  color: white;
  font-size: 11pt;
  font-weight: bold;
  text-shadow: black 0.1em 0.1em 0.2em;
}
.popover-content {
  min-width: 180px;
}
.map {
	height: 100%;
	width: 100%;
}
.ah {
	height: 100%;
}
.scrolly
{
overflow-y: scroll;
}
.normalcss
	  {
	      background:#E4E4E4;
	   }
	   .normalcss a
	   {
	       font-family:microsoft yahei,arial;
	       color:#000000;
	   }
	  .clickcss
	  {
	      background:#797979;
	   }
	   .clickcss a
	   {
	       font-family:microsoft yahei,arial;
	       color:#ffffff;
	   }
</style>
</head>
<body>

<div class="row ah">
  <div class="col-md-6 ah scrolly">
        <div class="col-md-12">
          <div class="jumbotron">
            <h1>SatSee服务地图</h1>
            <h3>我们的SatSee系统已经在全国十多家单位以及国外多个机构上安装运行。这个网页描述了目前已有的用户，以及我们目前正在开展的用户拓展工作。</h3>
			<p>(这也是和地图一起讲故事(StoryMap)的一个例子，你可以点击文章的任意位置来驱动地图移动，也可以点击地图上的图标来驱动文章重定位)</p>
          </div>
          <div class="row">
            <div onclick="javascript:view.centerOn(ol.proj.transform([87.616, 43.827], 'EPSG:4326', 'EPSG:3857'), map.getSize(), half);changecss(this);" class="normalcss">
              <h2 id="wlmq">新疆维吾尔自治区科技发展战略研究院购置了SatSee系统（点击我看看）</h2>
              <p></p>
			  <img src="img/wlmq1.jpg"/><br/><br/>
            </div><!--/.col-xs-6.col-lg-4-->
            <div onclick="javascript:view.centerOn(ol.proj.transform([104.894, 11.537], 'EPSG:4326', 'EPSG:3857'), map.getSize(), half);changecss(this);" class="normalcss">
              <h2 id="jinbian">在柬埔寨为吴哥窟管理局安装SatSee系统（点击我看看）</h2>
              <p></p>
			  <img src="img/jpz1.jpg"/><br/><br/>
			  <img src="img/jpz2.jpg"/><br/><br/>
            </div><!--/.col-xs-6.col-lg-4-->
            <div onclick="javascript:view.centerOn(ol.proj.transform([100.5, 13.75], 'EPSG:4326', 'EPSG:3857'), map.getSize(), half);changecss(this);" class="normalcss">
              <h2 id="bankok">在泰国安装SatSee系统（点击我看看）</h2>
              <h3>在GISTDA的接收站以及办公总部安装了三套SatseeLive和SatseeOrbit软件，颇受好评。
			  </h3>
			  <img src="img/bankok1.jpg"/><br/><br/>
			  <img src="img/bankok2.jpg"/><br/><br/>
			  <img src="img/bankok3.jpg"/><br/><br/>
            </div><!--/.col-xs-6.col-lg-4-->
            <div onclick="javascript:view.centerOn(ol.proj.transform([85.3, 27.75], 'EPSG:4326', 'EPSG:3857'), map.getSize(), half);changecss(this);" class="normalcss">
              <h2 id="nepal" >为尼泊尔地震处理国产高分1号数据（点击我看看）</h2>
                <h3>现在下载整理尼泊尔地震数据集。DigitalGlobe公司提供了地震前和地震后的大量数据，存放在云端。我们小组将下载这些数据，和我们已有的国产卫星数据组织在一起，为后续多星合作的数据处理打好测试数据的基础。
				</h3>
				<img src="http://novachen.github.io/images/e.gif"/><br/><br/>
				<img src="http://novachen.github.io/images/es.jpg"/><br/><br/>
				<img src="http://novachen.github.io/images/nepal_cut.gif"/><br/><br/>
            </div><!--/.col-xs-6.col-lg-4-->
			</div><!--/row-->
        </div><!--/.col-xs-12.col-sm-9-->  
  </div>
  <div class="col-md-6 ah">
    <div id="map" class="map"><div id="popup"></div></div>
  </div>

<div style="display: none;" id="mapinfo">
</div>

</div>
<script type="text/javascript">
    var fields = "曼谷,bankok,100.5,13.75;金边,jinbian,104.894,11.537;加德满都,nepal,85.3,27.75;乌鲁木齐,wlmq,87.616,43.827";
var layer = new ol.layer.Tile({
  source: new ol.source.MapQuest({layer: 'sat'})
});
var view = new ol.View({
    center: ol.proj.transform([100, 30], 'EPSG:4326', 'EPSG:3857'),
	zoom: 5
});		
var map = new ol.Map({
  layers: [layer],
  target: 'map',
  view: view
});
function changecss(obj) {
    var d = document.getElementsByClassName('clickcss');
    for (var i = 0; i < d.length; i++) {
        d[i].className = "normalcss";
    }
    obj.className = "clickcss";
}

var maphtml = "";
var s1 = fields.split(";");
for (var i = 1; i <= s1.length; i++) {
    var s2 = s1[i-1].split(",");
    maphtml += "<a class=\"overlay city\" id=\"city" +i + "\" href=\"#"+s2[1]+"\">" + s2[0] + "</a><div class=\"marker\" id=\"marker" + i + "\" title=\"Marker\"></div>";
}
document.getElementById("mapinfo").innerHTML = maphtml;

for (var i = 1; i <= s1.length; i++) {
    var s2 = s1[i-1].split(",");
    var a = new Array(parseFloat(s2[2]),parseFloat(s2[3]));
    var pos = ol.proj.fromLonLat(a);
    var marker = new ol.Overlay({
        position: pos,
        positioning: 'center-center',
        element: document.getElementById('marker' + i),
        stopEvent: false
    });
    map.addOverlay(marker);
}
for (var i = 1; i <= s1.length; i++) {
    var s2 = s1[i-1].split(",");
    var a = new Array(parseFloat(s2[2]), parseFloat(s2[3]));
    var pos = ol.proj.fromLonLat(a);
    var city = new ol.Overlay({
        position: pos,
        element: document.getElementById('city' + i)
    });
    map.addOverlay(city);
}
size = map.getSize();
half = [size[0] / 2, size[1] / 2];
</script>
</body>
</html>