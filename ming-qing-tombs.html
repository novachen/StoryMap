<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <meta charset="utf-8">

    <title>明清皇家陵寝</title>

    <script src="js/jquery.min.js"></script>
    <link rel="stylesheet" href="css/bootstrap.min.css">
    <script src="js/bootstrap.min.js"></script>

    <link rel="stylesheet" href="css/ol.css" type="text/css">
    <script src="js/ol.js"></script>

    <link href="css/offcanvas.css" rel="stylesheet">


    <style>
        .marker {
            width: 20px;
            height: 20px;
            border: 1px solid #088;
            border-radius: 10px;
            background-color: #0FF;
            opacity: 0.5;
        }

        .city {
            text-decoration: none;
            color: white;
            font-size: 11pt;
            font-weight: bold;
            text-shadow: black 0.1em 0.1em 0.2em;
        }

        .popover-content {
            min-width: 180px;
        }

        .map {
            height: 100%;
            width: 100%;
        }

        .ah {
            height: 100%;
        }

        .scrolly {
            overflow-y: auto;
        }

        .normalcss {
            background: #AAA;
        }

        .clickcss {
            background: #EEE;
        }

    </style>
</head>
<body>

<div class="row ah">
    <div class="col-md-6 ah scrolly">
        <div class="col-md-12">
            <div class="row normalcss">
                <h1>明清皇家陵寝</h1>
                <h3>南京明孝陵及明朝开国功臣陵寝，北京明十三陵，清关外三陵，清东陵，清西陵</h3>
            </div>
            <div class="row">
                <div onclick="showMap(this);changecss(this);" class="normalcss" id="ming-xiao-ling">
                    <h2>明孝陵</h2>
					<h3>明太祖朱元璋</h3>
                    <p>
                    </p>
                    <img src="http://www.wudangmuseum.com/UpFiles/article/gly/200906/2009063014521210368.JPG"/><br/>
                </div>
                <div onclick="showMap(this);changecss(this);" class="normalcss" id="ming-shi-san-ling">
                    <h2>明十三陵</h2>
                    <h3>明成祖朱棣迁都北京之后的十三个皇帝的陵寝</h3>
                    <p>
                    </p>
                    <img src="http://s11.sinaimg.cn/mw690/002uJpWpzy6NdRk3Sbwea"/><br/>
                </div>
                <div onclick="showMap(this);changecss(this);" class="normalcss" id="qing-fu-ling">
                    <h2>清福陵</h2>
                    <h3>清太祖努尔哈赤</h3>
                    <p>
                    </p>
                    <img src="http://lvyou.dzcnc.com/users/userUpfiles/huhuhu/sygg_034.JPG"/><br/>
                </div>
                <div onclick="showMap(this);changecss(this);" class="normalcss" id="qing-zhao-ling">
                    <h2>清昭陵</h2>
                    <h3>清太宗皇太极</h3>
                    <p>
                    </p>
                    <img src="http://lvyou.dzcnc.com/users/userUpfiles/huhuhu/sygg_035.JPG"/><br/>
                </div>
                <div onclick="showMap(this);changecss(this);" class="normalcss" id="qing-eastern">
                    <h2>清东陵</h2>
                    <h3>清顺治皇帝</h3>
                    <p>
                    </p>
                    <img src="http://pic.5tu.cn/uploads/allimg/1109/052149359300.jpg"/><br/>
                </div>
                <div onclick="showMap(this);changecss(this);" class="normalcss" id="qing-western">
                    <h2>清西陵</h2>
                    <h3>清康熙皇帝</h3>
                    <p>
                    </p>
                    <img src="http://manage.eblcu.cn/specls/cls/201103/course/3-2/09/08.jpg"/><br/>
                </div>
            </div>
            <!--/row-->
        </div>
        <!--/.col-xs-12.col-sm-9-->
    </div>
    <div class="col-md-6 ah">
        <div id="map" class="map">
            <div id="popup"></div>
        </div>
    </div>

    <div style="display: none;" id="mapinfo">
    </div>

</div>
<script type="text/javascript">
    var fields = "明孝陵,ming-xiao-ling,118.8345941310,32.0601992732;明十三陵,ming-shi-san-ling,116.2205630981,40.2930678675;清福陵,qing-fu-ling,123.5836071595,41.8327511629;清昭陵,qing-zhao-ling,123.4214402037,41.8476381014;清东陵,qing-eastern,117.6396176762,40.1871367136;清西陵,qing-western,115.3451678932,39.3686195420";

    var view = new ol.View({
        center: ol.proj.fromLonLat([116.405,39.901]),
        zoom: 6,
        minZoom: 3,
        maxZoom: 19
    })

    tileLayer = new ol.layer.Tile({
        source: new ol.source.BingMaps({
            imagerySet: 'Aerial',
            key: 'Ak-dzM4wZjSqTlzveKz5u0d4IQ4bRzVI309GxmkgSVr1ewS6iPSrOvOKhA-CJlm3'
        })
    });

    var map = new ol.Map({
        layers: [
            tileLayer
        ],
        target: 'map',
        view: view
    });

    function changecss(obj) {
        var d = document.getElementsByClassName('clickcss');
        for (var i = 0; i < d.length; i++) {
            d[i].className = "normalcss";
        }
        obj.className = "clickcss";
    }

    var maphtml = "";
    var s1 = fields.split(";");
    for (var i = 1; i <= s1.length; i++) {
        var s2 = s1[i - 1].split(",");
        maphtml += "<a class=\"overlay city\" id=\"city" + i + "\" href=\"#" + s2[1] + "\">" + s2[0] + "</a><div class=\"marker\" id=\"marker" + i + "\" title=\"Marker\"></div>";
    }
    document.getElementById("mapinfo").innerHTML = maphtml;

    for (var i = 1; i <= s1.length; i++) {
        var s2 = s1[i - 1].split(",");
        var a = new Array(parseFloat(s2[2]), parseFloat(s2[3]));
        var pos = ol.proj.fromLonLat(a);
        var marker = new ol.Overlay({
            position: pos,
            positioning: 'center-center',
            element: document.getElementById('marker' + i),
            stopEvent: false
        });
        map.addOverlay(marker);
        var city = new ol.Overlay({
            position: pos,
            element: document.getElementById('city' + i)
        });
        map.addOverlay(city);
    }
    size = map.getSize();
    half = [size[0] / 2, size[1] / 2];
    function showMap(obj) {
        var pointName = obj.id;
        for (var i = 1; i <= s1.length; i++) {
            var s2 = s1[i - 1].split(",");
            if (pointName == s2[1]) {
                //alert(pointName + "*****" + s2[1] + "*****" + s2[2] + "*****" + s2[3]);
                view.setCenter(ol.proj.fromLonLat([parseFloat(s2[2]), parseFloat(s2[3])]));
                view.setZoom(15);
            }
        }
    }
</script>
</body>
</html>